document.addEventListener("DOMContentLoaded",function(){const t=document.querySelector(".file_input-input"),n=document.querySelector(".file_input"),d=document.querySelector(".password_input"),o=document.querySelector(".password_input-input"),s=document.querySelector(".filename"),e=document.querySelector(".visibility_on"),i=document.querySelector(".visibility_off"),c=document.querySelector(".submit"),a=document.querySelector(".loader"),l=document.querySelector(".download_link"),r=document.querySelector(".start_over"),u=document.querySelector(".download_result");var m,h=document.querySelector(".url");function f(e){t.value=null,o.value=null,e||u.classList.add("hidden"),n.classList.remove("hidden"),a.classList.add("hidden")}t.addEventListener("change",function(e){e=e.target.files;0<e.length&&(m=e[0],n.classList.add("hidden"),s.textContent=m.name,d.classList.remove("hidden"))}),e.addEventListener("click",function(){o.type="password",e.classList.add("hidden"),i.classList.remove("hidden")}),i.addEventListener("click",function(){o.type="text",e.classList.remove("hidden"),i.classList.add("hidden")}),r.addEventListener("click",function(){f()}),c.addEventListener("click",function(){if(o.value&&t.value){n.classList.add("hidden"),d.classList.add("hidden"),a.classList.remove("hidden");const e=new FormData;e.append("file",m),e.append("password",o.value),fetch(h.href,{method:"POST",body:e}).then(e=>e.json()).then(e=>{"success"===e.message?function(e){const t=new WebSocket("ws://"+window.location.host+"/ws/download_result/"+e+"/");t.onmessage=function(e){e=JSON.parse(e.data);l.href=e.message.content,t.close(),a.classList.add("hidden"),u.classList.remove("hidden")}}(e.file_id):(Swal.fire({icon:"error",title:"Invalid input data",text:"Check and make sure that you entered all the data correctly.",heightAuto:!1,customClass:{container:"custom_container-swal2",popup:"custom_popup-swal2",confirmButton:"custom_confirmbutton-swal2"}}),f(!0))})}})});