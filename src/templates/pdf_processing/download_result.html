{% extends '../base.html' %}
{% load static %}
{% block head %}
    <link rel="stylesheet" href="{% static 'css/pdf_processing/style.css' %}">
{% endblock head %}
{% block content %}
    <section class="tool_detail">
        <div class="container">
            <a href="{{ url }}" id="download_link" download>Завантажити результат</a>
        </div>
    </section>
{% endblock content %}
{% block js %}
    {{ file_id|json_script:"file-id" }}
    <script>
        const roomName = JSON.parse(document.getElementById('file-id').textContent);
        const chatSocket = new WebSocket(
            'ws://'
            + window.location.host
            + '/ws/download_result/'
            + roomName
            + '/'
        );

        chatSocket.onmessage = function (e) {
            const data = JSON.parse(e.data);
            console.log(data);
            chatSocket.close();
        };
    </script>
{% endblock js %}
